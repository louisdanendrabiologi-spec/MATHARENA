<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MathArena - Latihan Matematika</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- CSS DIBAWAH SINI -->
    <style>
        :root {
            --bg: #0a0e17;
            --bg-secondary: #111827;
            --fg: #e8edf5;
            --muted: #6b7a94;
            --accent: #00d4aa;
            --accent-glow: rgba(0, 212, 170, 0.3);
            --card: rgba(17, 24, 39, 0.8);
            --border: rgba(107, 122, 148, 0.2);
            --danger: #ff4757;
            --success: #00d4aa;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg);
            color: var(--fg);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* BACKGROUND */
        .bg-pattern {
            position: fixed;
            inset: 0;
            z-index: 0;
            overflow: hidden;
            pointer-events: none;
        }
        .bg-pattern::before {
            content: '';
            position: absolute;
            inset: -50%;
            background: radial-gradient(circle at 20% 30%, rgba(0, 212, 170, 0.08) 0%, transparent 50%),
                        radial-gradient(circle at 80% 70%, rgba(0, 150, 255, 0.06) 0%, transparent 50%);
            animation: bgPulse 15s ease-in-out infinite;
        }
        @keyframes bgPulse {
            0%, 100% { transform: scale(1) rotate(0deg); opacity: 1; }
            50% { transform: scale(1.1) rotate(5deg); opacity: 0.8; }
        }
        .grid-lines {
            position: absolute;
            inset: 0;
            background-image: linear-gradient(rgba(0, 212, 170, 0.03) 1px, transparent 1px),
                              linear-gradient(90deg, rgba(0, 212, 170, 0.03) 1px, transparent 1px);
            background-size: 60px 60px;
            animation: gridMove 20s linear infinite;
        }
        @keyframes gridMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(60px, 60px); }
        }
        #particles { position: fixed; inset: 0; z-index: 1; pointer-events: none; }
        .particle {
            position: absolute;
            width: 4px; height: 4px;
            background: var(--accent);
            border-radius: 50%;
            opacity: 0.4;
            animation: float 8s ease-in-out infinite;
        }
        @keyframes float {
            0%, 100% { transform: translateY(0) scale(1); opacity: 0.4; }
            50% { transform: translateY(-100px) scale(1.5); opacity: 0.8; }
        }

        /* NAVIGATION */
        .main-container { position: relative; z-index: 10; min-height: 100vh; }
        .nav {
            position: fixed; top: 0; left: 0; right: 0; z-index: 100;
            background: rgba(10, 14, 23, 0.9);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border);
            padding: 1rem 2rem;
        }
        .nav-content {
            max-width: 1400px; margin: 0 auto;
            display: flex; justify-content: space-between; align-items: center;
        }
        .logo {
            font-family: 'Orbitron', sans-serif;
            font-weight: 900; font-size: 1.5rem;
            color: var(--accent);
            text-shadow: 0 0 20px var(--accent-glow);
        }
        .nav-links { display: flex; gap: 0.5rem; }
        .nav-btn {
            padding: 0.5rem 1rem; border-radius: 8px;
            border: 1px solid transparent; background: transparent;
            color: var(--muted); cursor: pointer;
            transition: all 0.3s ease; font-weight: 500;
        }
        .nav-btn:hover { color: var(--fg); background: rgba(255,255,255,0.05); }
        .nav-btn.active { background: var(--accent); color: var(--bg); border-color: var(--accent); }

        /* HERO */
        .hero { padding: 8rem 2rem 4rem; text-align: center; max-width: 900px; margin: 0 auto; }
        .hero-title {
            font-family: 'Orbitron', sans-serif;
            font-size: clamp(2.5rem, 8vw, 4.5rem);
            font-weight: 900; line-height: 1.1; margin-bottom: 1.5rem;
            background: linear-gradient(135deg, var(--fg) 0%, var(--accent) 100%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .hero-subtitle { font-size: 1.125rem; color: var(--muted); margin-bottom: 2rem; }

        /* STATS */
        .stats-bar { display: flex; justify-content: center; gap: 1rem; flex-wrap: wrap; margin-bottom: 2rem; }
        .stat-item {
            text-align: center; padding: 1.25rem 1.5rem;
            background: var(--card); border-radius: 16px;
            border: 1px solid var(--border); backdrop-filter: blur(10px);
            min-width: 120px; transition: all 0.3s ease;
        }
        .stat-item:hover { transform: translateY(-4px); border-color: var(--accent); }
        .stat-value { font-family: 'Orbitron', sans-serif; font-size: 1.75rem; font-weight: 700; color: var(--accent); }
        .stat-label { font-size: 0.8rem; color: var(--muted); margin-top: 0.25rem; text-transform: uppercase; }

        /* RANK BADGE */
        .rank-badge {
            display: inline-flex; align-items: center; gap: 0.75rem;
            padding: 0.875rem 1.75rem; border-radius: 50px;
            font-weight: 600; font-size: 1rem; margin-top: 1rem;
            animation: rankGlow 2s ease-in-out infinite;
        }
        @keyframes rankGlow {
            0%, 100% { box-shadow: 0 0 20px var(--rank-glow); }
            50% { box-shadow: 0 0 40px var(--rank-glow); }
        }
        .rank-novice { background: linear-gradient(135deg, #4a5568, #2d3748); --rank-glow: rgba(107, 122, 148, 0.4); }
        .rank-apprentice { background: linear-gradient(135deg, #38a169, #276749); --rank-glow: rgba(56, 161, 105, 0.4); }
        .rank-scholar { background: linear-gradient(135deg, #3182ce, #2c5282); --rank-glow: rgba(49, 130, 206, 0.4); }
        .rank-expert { background: linear-gradient(135deg, #d69e2e, #b7791f); --rank-glow: rgba(214, 158, 46, 0.4); }
        .rank-master { background: linear-gradient(135deg, #e53e3e, #c53030); --rank-glow: rgba(229, 62, 62, 0.4); }
        .rank-grandmaster { background: linear-gradient(135deg, #805ad5, #6b46c1); --rank-glow: rgba(128, 90, 213, 0.4); }
        .rank-legend { background: linear-gradient(135deg, #00d4aa, #00a884); --rank-glow: rgba(0, 212, 170, 0.4); }

        /* SECTIONS */
        .section { max-width: 1200px; margin: 0 auto; padding: 4rem 2rem; }
        .section-header { text-align: center; margin-bottom: 3rem; }
        .section-title { font-family: 'Orbitron', sans-serif; font-size: 2rem; font-weight: 700; margin-bottom: 0.75rem; color: var(--fg); }
        .section-desc { color: var(--muted); font-size: 1rem; }

        /* RANK PROGRESS */
        .rank-progress-section {
            background: var(--card); border: 1px solid var(--border);
            border-radius: 24px; padding: 2rem; backdrop-filter: blur(10px);
        }
        .progress-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; flex-wrap: wrap; gap: 1rem; }
        .current-rank-info { display: flex; align-items: center; gap: 1rem; }
        .current-rank-icon {
            width: 64px; height: 64px; border-radius: 16px;
            display: flex; align-items: center; justify-content: center; font-size: 1.5rem;
        }
        .rank-name { font-family: 'Orbitron', sans-serif; font-size: 1.5rem; font-weight: 700; }
        .rank-points { color: var(--muted); font-size: 0.9rem; }
        .progress-bar { height: 14px; background: rgba(0,0,0,0.4); border-radius: 7px; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--accent), #00a884); border-radius: 7px; transition: width 0.5s ease; position: relative; }
        .progress-fill::after {
            content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: progressShine 2s infinite;
        }
        @keyframes progressShine { 0% { transform: translateX(-100%); } 100% { transform: translateX(100%); } }
        .progress-text { display: flex; justify-content: space-between; font-size: 0.85rem; color: var(--muted); margin-top: 0.5rem; }
        .ranks-list { display: flex; gap: 0.5rem; overflow-x: auto; padding: 0.5rem 0; }
        .rank-item { flex-shrink: 0; padding: 0.75rem 1rem; border-radius: 12px; text-align: center; min-width: 100px; opacity: 0.5; transition: all 0.3s ease; border: 2px solid transparent; }
        .rank-item.current { opacity: 1; transform: scale(1.05); }
        .rank-item-name { font-weight: 700; font-size: 0.85rem; margin-bottom: 0.25rem; }
        .rank-item-points { font-size: 0.75rem; opacity: 0.8; }

        /* DIFFICULTY GRID */
        .difficulty-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 1.5rem; }
        .difficulty-card {
            background: var(--card); border: 1px solid var(--border);
            border-radius: 20px; padding: 2rem; cursor: pointer;
            transition: all 0.3s ease; position: relative; overflow: hidden;
        }
        .difficulty-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px; background: var(--card-accent, var(--accent)); }
        .difficulty-card:hover { transform: translateY(-8px); border-color: var(--card-accent, var(--accent)); box-shadow: 0 20px 50px rgba(0,0,0,0.4); }
        .difficulty-card.easy { --card-accent: #00d4aa; }
        .difficulty-card.medium { --card-accent: #ffa502; }
        .difficulty-card.hard { --card-accent: #ff4757; }
        .difficulty-card.extreme { --card-accent: #805ad5; }
        .difficulty-icon {
            width: 60px; height: 60px; border-radius: 16px;
            display: flex; align-items: center; justify-content: center;
            margin-bottom: 1.25rem; background: rgba(0,0,0,0.3);
            color: var(--card-accent);
        }
        .difficulty-name { font-family: 'Orbitron', sans-serif; font-size: 1.25rem; font-weight: 700; margin-bottom: 0.5rem; }
        .difficulty-desc { color: var(--muted); font-size: 0.9rem; margin-bottom: 1rem; line-height: 1.5; }
        .difficulty-meta { display: flex; justify-content: space-between; padding-top: 1rem; border-top: 1px solid var(--border); }
        .difficulty-points { font-size: 0.9rem; color: var(--card-accent); font-weight: 700; }

        /* LEADERBOARD */
        .leaderboard-container { background: var(--card); border: 1px solid var(--border); border-radius: 24px; overflow: hidden; }
        .leaderboard-header { background: linear-gradient(135deg, rgba(0,212,170,0.1), transparent); padding: 1.5rem 2rem; border-bottom: 1px solid var(--border); }
        .leaderboard-title { font-family: 'Orbitron', sans-serif; font-size: 1.25rem; font-weight: 700; }
        .leaderboard-tabs { display: flex; gap: 0.5rem; margin-top: 1rem; }
        .tab-btn { padding: 0.5rem 1rem; border-radius: 8px; border: 1px solid var(--border); background: transparent; color: var(--muted); cursor: pointer; transition: all 0.2s ease; font-size: 0.85rem; }
        .tab-btn.active { background: var(--accent); color: var(--bg); border-color: var(--accent); }
        .leaderboard-list { padding: 1rem; max-height: 600px; overflow-y: auto; }
        .leaderboard-item { display: flex; align-items: center; gap: 1rem; padding: 1rem 1.25rem; border-radius: 16px; margin-bottom: 0.5rem; background: rgba(0,0,0,0.2); border: 1px solid transparent; }
        .leaderboard-item:hover { background: rgba(0,212,170,0.05); }
        .leaderboard-item.current-user { border-color: var(--accent); background: rgba(0,212,170,0.1); }
        .rank-number { width: 44px; height: 44px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-family: 'Orbitron', sans-serif; font-weight: 700; flex-shrink: 0; }
        .rank-1 { background: linear-gradient(135deg, #ffd700, #ffb300); color: #000; }
        .rank-2 { background: linear-gradient(135deg, #e8e8e8, #a0a0a0); color: #000; }
        .rank-3 { background: linear-gradient(135deg, #cd7f32, #a0522d); color: #fff; }
        .rank-other { background: var(--bg-secondary); color: var(--muted); }
        .player-avatar { width: 48px; height: 48px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-weight: 700; flex-shrink: 0; }
        .player-info { flex: 1; min-width: 0; }
        .player-name { font-weight: 600; margin-bottom: 0.25rem; }
        .player-score { font-family: 'Orbitron', sans-serif; font-weight: 700; color: var(--accent); font-size: 1.125rem; flex-shrink: 0; }

        /* MODALS */
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.85); backdrop-filter: blur(10px); z-index: 200; display: none; align-items: center; justify-content: center; padding: 1rem; }
        .modal-overlay.active { display: flex; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        /* QUIZ CONTAINER */
        .quiz-container { background: var(--bg-secondary); border-radius: 24px; border: 1px solid var(--border); width: 100%; max-width: 600px; padding: 2rem; animation: slideUp 0.4s ease; }
        @keyframes slideUp { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .quiz-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; }
        .quiz-info { display: flex; align-items: center; gap: 1rem; }
        .quiz-difficulty { padding: 0.375rem 0.875rem; border-radius: 20px; font-size: 0.8rem; font-weight: 600; text-transform: uppercase; }
        .quiz-difficulty.easy { background: rgba(0,212,170,0.2); color: #00d4aa; }
        .quiz-difficulty.medium { background: rgba(255,165,2,0.2); color: #ffa502; }
        .quiz-difficulty.hard { background: rgba(255,71,87,0.2); color: #ff4757; }
        .quiz-difficulty.extreme { background: rgba(128,90,213,0.2); color: #805ad5; }
        .quiz-timer { font-family: 'Orbitron', sans-serif; font-size: 1.5rem; color: var(--accent); background: rgba(0,212,170,0.1); padding: 0.5rem 1rem; border-radius: 12px; min-width: 70px; text-align: center; }
        .quiz-timer.warning { color: var(--danger); background: rgba(255,71,87,0.15); animation: timerPulse 0.5s ease infinite; }
        @keyframes timerPulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
        
        .question-card { background: rgba(0,0,0,0.3); border-radius: 20px; padding: 2.5rem 2rem; margin-bottom: 2rem; text-align: center; border: 1px solid var(--border); }
        .question-text { font-size: 2rem; font-weight: 600; margin-bottom: 0.5rem; font-family: 'Orbitron', sans-serif; }
        .question-hint { color: var(--muted); font-size: 0.85rem; }
        .options-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; margin-bottom: 1.5rem; }
        .option-btn { padding: 1.25rem 1.5rem; border-radius: 16px; border: 2px solid var(--border); background: rgba(0,0,0,0.2); color: var(--fg); font-size: 1.125rem; cursor: pointer; transition: all 0.2s ease; font-weight: 600; font-family: 'Orbitron', sans-serif; }
        .option-btn:hover:not(:disabled) { border-color: var(--accent); background: rgba(0,212,170,0.1); transform: translateY(-2px); }
        .option-btn.correct { border-color: var(--success); background: rgba(0,212,170,0.2); color: var(--success); }
        .option-btn.wrong { border-color: var(--danger); background: rgba(255,71,87,0.2); color: var(--danger); }
        .option-btn:disabled { cursor: not-allowed; opacity: 0.7; }

        /* RESULT CONTAINER */
        .result-container { text-align: center; padding: 1rem; }
        .result-icon { width: 100px; height: 100px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1.5rem; font-size: 2rem; }
        .result-icon.success { background: rgba(0,212,170,0.15); color: var(--success); }
        .result-score { font-family: 'Orbitron', sans-serif; font-size: 3rem; font-weight: 900; color: var(--accent); margin-bottom: 1.5rem; }
        .result-stats { display: flex; justify-content: center; gap: 2rem; margin-bottom: 1.5rem; }
        .result-stat-value { display: block; font-family: 'Orbitron', sans-serif; font-size: 1.75rem; font-weight: 700; color: var(--fg); }
        .result-stat-label { font-size: 0.85rem; color: var(--muted); }
        .result-message { color: var(--muted); margin-bottom: 2rem; font-size: 1rem; }
        .result-actions { display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap; }

        /* BUTTONS */
        .btn { padding: 0.875rem 2rem; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.2s ease; border: 2px solid transparent; font-size: 0.95rem; }
        .btn-primary { background: var(--accent); color: var(--bg); }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 10px 30px var(--accent-glow); }
        .btn-secondary { background: transparent; border-color: var(--border); color: var(--fg); }
        .btn-secondary:hover { border-color: var(--accent); color: var(--accent); }

        /* SETTINGS PANEL */
        .settings-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.6); z-index: 250; display: none; }
        .settings-overlay.active { display: block; }
        .settings-panel { position: fixed; top: 0; right: -420px; width: 400px; max-width: 100vw; height: 100vh; background: var(--bg-secondary); border-left: 1px solid var(--border); z-index: 300; transition: right 0.3s ease; overflow-y: auto; display: flex; flex-direction: column; }
        .settings-panel.active { right: 0; }
        .settings-header { display: flex; justify-content: space-between; align-items: center; padding: 1.5rem 2rem; border-bottom: 1px solid var(--border); background: rgba(0,0,0,0.2); }
        .settings-title { font-family: 'Orbitron', sans-serif; font-size: 1.25rem; }
        .close-btn { width: 44px; height: 44px; border-radius: 12px; border: 1px solid var(--border); background: transparent; color: var(--fg); cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s ease; }
        .close-btn:hover { border-color: var(--danger); color: var(--danger); background: rgba(255,71,87,0.1); }
        .settings-content { flex: 1; padding: 1.5rem 2rem; }
        .settings-section { margin-bottom: 2rem; }
        .settings-section-title { font-size: 0.85rem; font-weight: 600; color: var(--muted); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 1rem; }
        .form-group { margin-bottom: 1.25rem; }
        .form-label { display: block; margin-bottom: 0.5rem; font-weight: 500; font-size: 0.9rem; }
        .form-input { width: 100%; padding: 0.875rem 1rem; border-radius: 12px; border: 1px solid var(--border); background: rgba(0,0,0,0.3); color: var(--fg); font-size: 1rem; transition: all 0.2s ease; font-family: inherit; }
        .form-input:focus { outline: none; border-color: var(--accent); box-shadow: 0 0 0 3px var(--accent-glow); }
        .settings-actions { display: flex; flex-direction: column; gap: 0.75rem; margin-top: 2rem; padding-top: 2rem; border-top: 1px solid var(--border); }
        .btn-danger { background: transparent; border-color: var(--danger); color: var(--danger); }
        .btn-danger:hover { background: var(--danger); color: #fff; }

        /* TOAST */
        .toast { position: fixed; bottom: 2rem; right: 2rem; padding: 1rem 1.5rem; border-radius: 12px; background: var(--bg-secondary); border: 1px solid var(--border); z-index: 400; transform: translateY(100px); opacity: 0; transition: all 0.3s ease; max-width: 300px; font-weight: 500; }
        .toast.show { transform: translateY(0); opacity: 1; }
        .toast.success { border-color: var(--success); background: rgba(0,212,170,0.1); color: var(--success); }

        /* RESPONSIVE */
        @media (max-width: 768px) {
            .nav-content { flex-wrap: wrap; gap: 1rem; }
            .nav-links { order: 3; width: 100%; justify-content: center; flex-wrap: wrap; }
            .hero { padding: 6rem 1rem 2rem; }
            .stats-bar { gap: 0.75rem; }
            .stat-item { min-width: 90px; padding: 1rem; }
            .section { padding: 2rem 1rem; }
            .quiz-container { padding: 1.5rem; border-radius: 20px; }
            .question-text { font-size: 1.5rem; }
            .options-grid { grid-template-columns: 1fr; }
            .option-btn { padding: 1rem; font-size: 1rem; }
            .settings-panel { width: 100%; }
        }
    </style>
</head>
<body>
    <!-- BACKGROUND -->
    <div class="bg-pattern"><div class="grid-lines"></div></div>
    <div id="particles"></div>

    <!-- MAIN CONTAINER -->
    <div class="main-container">
        <!-- NAVIGATION -->
        <nav class="nav">
            <div class="nav-content">
                <div class="logo">MathArena</div>
                <div class="nav-links">
                    <button class="nav-btn active" data-page="home">Beranda</button>
                    <button class="nav-btn" data-page="leaderboard">Peringkat</button>
                    <button class="nav-btn" id="settingsBtn">Pengaturan</button>
                </div>
            </div>
        </nav>

        <!-- HOME PAGE -->
        <main id="homePage">
            <section class="hero">
                <h1 class="hero-title">Kuasai Matematika</h1>
                <p class="hero-subtitle">Latih kemampuan matematikamu, kumpulkan poin, dan bersainglah untuk menjadi yang terbaik.</p>
                
                <div class="stats-bar">
                    <div class="stat-item"><div class="stat-value" id="totalPoints">0</div><div class="stat-label">Poin</div></div>
                    <div class="stat-item"><div class="stat-value" id="totalCorrect">0</div><div class="stat-label">Benar</div></div>
                    <div class="stat-item"><div class="stat-value" id="accuracy">0%</div><div class="stat-label">Akurasi</div></div>
                </div>
                <div id="currentRankBadge" class="rank-badge rank-novice"><span id="currentRankText">Novice</span></div>
            </section>

            <section class="section">
                <div class="rank-progress-section">
                    <div class="progress-header">
                        <div class="current-rank-info">
                            <div id="currentRankIcon" class="current-rank-icon rank-novice">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
                            </div>
                            <div>
                                <div id="currentRankName" class="rank-name">Novice</div>
                                <div id="currentRankPointsText" class="rank-points">0 / 100 poin</div>
                            </div>
                        </div>
                    </div>
                    <div class="progress-bar-container">
                        <div class="progress-bar"><div id="progressFill" class="progress-fill" style="width: 0%"></div></div>
                        <div class="progress-text"><span id="progressCurrent">0 poin</span><span id="progressNext">100 poin</span></div>
                    </div>
                    <div id="ranksList" class="ranks-list"></div>
                </div>
            </section>

            <section class="section">
                <div class="section-header">
                    <h2 class="section-title">Pilih Tingkat Kesulitan</h2>
                    <p class="section-desc">Semakin sulit, semakin banyak poin</p>
                </div>
                <div class="difficulty-grid">
                    <div class="difficulty-card easy" data-difficulty="easy">
                        <div class="difficulty-icon"><svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/><line x1="9" y1="9" x2="9.01" y2="9"/><line x1="15" y1="9" x2="15.01" y2="9"/></svg></div>
                        <div class="difficulty-name">Mudah</div>
                        <div class="difficulty-desc">Penjumlahan, pengurangan, perkalian dasar</div>
                        <div class="difficulty-meta"><span class="difficulty-points">+10 poin</span></div>
                    </div>
                    <div class="difficulty-card medium" data-difficulty="medium">
                        <div class="difficulty-icon"><svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></svg></div>
                        <div class="difficulty-name">Menengah</div>
                        <div class="difficulty-desc">Pembagian, pecahan sederhana, persentase</div>
                        <div class="difficulty-meta"><span class="difficulty-points">+20 poin</span></div>
                    </div>
                    <div class="difficulty-card hard" data-difficulty="hard">
                        <div class="difficulty-icon"><svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 6.5 5.5 17.5 18.5 17.5 12 6.5"/></svg></div>
                        <div class="difficulty-name">Sulit</div>
                        <div class="difficulty-desc">Aljabar, persamaan, operasi campuran</div>
                        <div class="difficulty-meta"><span class="difficulty-points">+30 poin</span></div>
                    </div>
                    <div class="difficulty-card extreme" data-difficulty="extreme">
                        <div class="difficulty-icon"><svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg></div>
                        <div class="difficulty-name">Ekstrem</div>
                        <div class="difficulty-desc">Pangkat, akar, logaritma, geometri</div>
                        <div class="difficulty-meta"><span class="difficulty-points">+50 poin</span></div>
                    </div>
                </div>
            </section>
        </main>

        <!-- LEADERBOARD PAGE -->
        <main id="leaderboardPage" style="display: none;">
            <section class="section" style="padding-top: 8rem;">
                <div class="section-header">
                    <h2 class="section-title">Papan Peringkat Global</h2>
                </div>
                <div class="leaderboard-container">
                    <div class="leaderboard-header">
                        <div class="leaderboard-title">Top Pemain</div>
                    </div>
                    <div id="leaderboardList" class="leaderboard-list"></div>
                </div>
            </section>
        </main>
    </div>

    <!-- QUIZ MODAL -->
    <div id="quizModal" class="modal-overlay">
        <div class="quiz-container">
            <div class="quiz-header">
                <div class="quiz-info"><span class="quiz-difficulty" id="quizDifficulty">Mudah</span><span>Soal <span id="currentQuestion">1</span>/<span id="totalQuestions">10</span></span></div>
                <div class="quiz-timer" id="quizTimer">30</div>
            </div>
            <div class="question-card">
                <div class="question-text" id="questionText">12 + 8 = ?</div>
                <div class="question-hint" id="questionHint">Pilih jawaban yang benar</div>
            </div>
            <div class="options-grid" id="optionsGrid"></div>
        </div>
    </div>

    <!-- RESULT MODAL -->
    <div id="resultModal" class="modal-overlay">
        <div class="quiz-container result-container">
            <div class="result-icon success"><svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg></div>
            <div class="result-score" id="resultScore">0 Poin</div>
            <div class="result-stats">
                <div class="result-stat"><span class="result-stat-value" id="resultCorrect">0</span><span class="result-stat-label">Benar</span></div>
                <div class="result-stat"><span class="result-stat-value" id="resultWrong">0</span><span class="result-stat-label">Salah</span></div>
            </div>
            <div class="result-message" id="resultMessage">Kerja bagus!</div>
            <div class="result-actions">
                <button class="btn btn-secondary" onclick="closeResult()">Kembali</button>
                <button class="btn btn-primary" onclick="restartQuiz()">Main Lagi</button>
            </div>
        </div>
    </div>

    <!-- SETTINGS PANEL -->
    <div id="settingsOverlay" class="settings-overlay"></div>
    <div id="settingsPanel" class="settings-panel">
        <div class="settings-header">
            <div class="settings-title">Pengaturan</div>
            <button class="close-btn" id="closeSettings"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button>
        </div>
        <div class="settings-content">
            <div class="settings-section">
                <h4 class="settings-section-title">Profil</h4>
                <div class="form-group">
                    <label class="form-label">Nama Pemain</label>
                    <input type="text" id="playerNameInput" class="form-input" placeholder="Masukkan namamu" maxlength="20">
                </div>
            </div>
            <div class="settings-section">
                <h4 class="settings-section-title">Game</h4>
                <div class="form-group">
                    <label class="form-label">Jumlah Soal</label>
                    <select id="questionCountSelect" class="form-input">
                        <option value="5">5 Soal</option>
                        <option value="10" selected>10 Soal</option>
                        <option value="15">15 Soal</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Waktu per Soal</label>
                    <select id="timePerQuestionSelect" class="form-input">
                        <option value="15">15 detik</option>
                        <option value="30" selected>30 detik</option>
                        <option value="45">45 detik</option>
                    </select>
                </div>
            </div>
            <div class="settings-actions">
                <button class="btn btn-primary" onclick="saveSettings()">Simpan</button>
                <button class="btn btn-danger" onclick="resetProgress()">Reset Progress</button>
            </div>
        </div>
    </div>

    <!-- TOAST -->
    <div id="toast" class="toast"></div>

    <!-- JAVASCRIPT DIBAWAH SINI -->
    <script>
        // =====================
        // CONFIGURATION
        // =====================
        const RANKS = [
            { name: 'Novice', minPoints: 0, maxPoints: 99, class: 'rank-novice', color: '#6b7a94' },
            { name: 'Apprentice', minPoints: 100, maxPoints: 249, class: 'rank-apprentice', color: '#38a169' },
            { name: 'Scholar', minPoints: 250, maxPoints: 499, class: 'rank-scholar', color: '#3182ce' },
            { name: 'Expert', minPoints: 500, maxPoints: 999, class: 'rank-expert', color: '#d69e2e' },
            { name: 'Master', minPoints: 1000, maxPoints: 1999, class: 'rank-master', color: '#e53e3e' },
            { name: 'Grandmaster', minPoints: 2000, maxPoints: 4999, class: 'rank-grandmaster', color: '#805ad5' },
            { name: 'Legend', minPoints: 5000, maxPoints: Infinity, class: 'rank-legend', color: '#00d4aa' }
        ];
        const DIFFICULTY_CONFIG = {
            easy: { points: 10, time: 30, name: 'Mudah' },
            medium: { points: 20, time: 40, name: 'Menengah' },
            hard: { points: 30, time: 50, name: 'Sulit' },
            extreme: { points: 50, time: 60, name: 'Ekstrem' }
        };
        const LEADERBOARD_DATA = [
            { name: 'MathWiz', points: 8540, rank: 'Legend', avatar: 'MW' },
            { name: 'NumberCruncher', points: 6230, rank: 'Legend', avatar: 'NC' },
            { name: 'CalcMaster', points: 4890, rank: 'Grandmaster', avatar: 'CM' },
            { name: 'AlgebraKing', points: 3560, rank: 'Grandmaster', avatar: 'AK' },
            { name: 'ProblemSolver', points: 2890, rank: 'Master', avatar: 'PS' },
            { name: 'EquationExpert', points: 2100, rank: 'Master', avatar: 'EE' },
            { name: 'MathNinja', points: 1650, rank: 'Master', avatar: 'MN' },
            { name: 'CalcPro', points: 1200, rank: 'Master', avatar: 'CP' },
            { name: 'NumberGenius', points: 890, rank: 'Expert', avatar: 'NG' },
            { name: 'MathHero', points: 650, rank: 'Expert', avatar: 'MH' }
        ];

        // =====================
        // STATE
        // =====================
        let userData = { name: 'Player', points: 0, correctAnswers: 0, totalAnswers: 0 };
        let settings = { questionCount: 10, timePerQuestion: 30 };
        let quizState = { questions: [], currentIndex: 0, score: 0, correctCount: 0, timeLeft: 30, timerInterval: null, difficulty: 'easy' };

        // =====================
        // INITIALIZATION
        // =====================
        function init() {
            loadData();
            createParticles();
            updateUI();
            renderRanksList();
            renderLeaderboard();
            setupEventListeners();
        }
        function loadData() {
            const saved = localStorage.getItem('mathArenaData');
            if (saved) userData = { ...userData, ...JSON.parse(saved) };
            const savedSettings = localStorage.getItem('mathArenaSettings');
            if (savedSettings) {
                settings = { ...settings, ...JSON.parse(savedSettings) };
                document.getElementById('questionCountSelect').value = settings.questionCount;
                document.getElementById('timePerQuestionSelect').value = settings.timePerQuestion;
            }
            document.getElementById('playerNameInput').value = userData.name;
        }
        function saveData() {
            localStorage.setItem('mathArenaData', JSON.stringify(userData));
            localStorage.setItem('mathArenaSettings', JSON.stringify(settings));
        }
        function createParticles() {
            const container = document.getElementById('particles');
            for (let i = 0; i < 20; i++) {
                const p = document.createElement('div');
                p.className = 'particle';
                p.style.left = Math.random() * 100 + '%';
                p.style.top = Math.random() * 100 + '%';
                p.style.animationDelay = Math.random() * 8 + 's';
                container.appendChild(p);
            }
        }

        // =====================
        // UI UPDATES
        // =====================
        function updateUI() {
            document.getElementById('totalPoints').textContent = userData.points;
            document.getElementById('totalCorrect').textContent = userData.correctAnswers;
            const acc = userData.totalAnswers > 0 ? Math.round((userData.correctAnswers / userData.totalAnswers) * 100) : 0;
            document.getElementById('accuracy').textContent = acc + '%';
            
            const currentRank = getCurrentRank();
            document.getElementById('currentRankBadge').className = 'rank-badge ' + currentRank.class;
            document.getElementById('currentRankText').textContent = currentRank.name;
            document.getElementById('currentRankName').textContent = currentRank.name;
            document.getElementById('currentRankIcon').className = 'current-rank-icon ' + currentRank.class;
            
            const nextRank = getNextRank();
            const progress = nextRank ? ((userData.points - currentRank.minPoints) / (nextRank.minPoints - currentRank.minPoints)) * 100 : 100;
            document.getElementById('progressFill').style.width = Math.min(progress, 100) + '%';
            document.getElementById('progressCurrent').textContent = userData.points + ' poin';
            document.getElementById('progressNext').textContent = nextRank ? nextRank.minPoints + ' poin' : 'MAX';
            document.getElementById('currentRankPointsText').textContent = nextRank ? `${userData.points} / ${nextRank.minPoints} poin` : `${userData.points} poin (MAX)`;
        }
        function getCurrentRank() {
            for (let i = RANKS.length - 1; i >= 0; i--) if (userData.points >= RANKS[i].minPoints) return RANKS[i];
            return RANKS[0];
        }
        function getNextRank() {
            const idx = RANKS.indexOf(getCurrentRank());
            return idx < RANKS.length - 1 ? RANKS[idx + 1] : null;
        }
        function renderRanksList() {
            const current = getCurrentRank();
            document.getElementById('ranksList').innerHTML = RANKS.map(r => {
                let status = r.name === current.name ? 'current' : (userData.points >= r.maxPoints + 1 ? 'passed' : '');
                return `<div class="rank-item ${status} ${r.class}" style="background: ${status ? r.color + '22' : 'transparent'}; border-color: ${status === 'current' ? r.color : 'transparent'}"><div class="rank-item-name" style="color: ${r.color}">${r.name}</div><div class="rank-item-points">${r.minPoints}+ poin</div></div>`;
            }).join('');
        }
        function renderLeaderboard() {
            const all = [...LEADERBOARD_DATA, { name: userData.name, points: userData.points, rank: getCurrentRank().name, avatar: userData.name.substring(0, 2).toUpperCase(), isCurrentUser: true }];
            all.sort((a, b) => b.points - a.points);
            document.getElementById('leaderboardList').innerHTML = all.slice(0, 20).map((p, i) => {
                const rk = i < 3 ? `rank-${i + 1}` : 'rank-other';
                const rankInfo = RANKS.find(r => r.name === p.rank) || RANKS[0];
                return `<div class="leaderboard-item ${p.isCurrentUser ? 'current-user' : ''}"><div class="rank-number ${rk}">${i + 1}</div><div class="player-avatar" style="background: linear-gradient(135deg, ${rankInfo.color}, ${rankInfo.color}88)">${p.avatar}</div><div class="player-info"><div class="player-name">${p.name} ${p.isCurrentUser ? '(Kamu)' : ''}</div></div><div class="player-score">${p.points.toLocaleString()}</div></div>`;
            }).join('');
        }

        // =====================
        // QUESTION GENERATOR
        // =====================
        function generateQuestion(diff) {
            let q, a, h;
            if (diff === 'easy') {
                const t = Math.floor(Math.random() * 3);
                if (t === 0) { const x = Math.floor(Math.random() * 50) + 1, y = Math.floor(Math.random() * 50) + 1; q = `${x} + ${y} = ?`; a = x + y; h = 'Penjumlahan'; }
                else if (t === 1) { const x = Math.floor(Math.random() * 50) + 20, y = Math.floor(Math.random() * Math.min(x, 30)) + 1; q = `${x} - ${y} = ?`; a = x - y; h = 'Pengurangan'; }
                else { const x = Math.floor(Math.random() * 10) + 2, y = Math.floor(Math.random() * 10) + 2; q = `${x} × ${y} = ?`; a = x * y; h = 'Perkalian'; }
            } else if (diff === 'medium') {
                const t = Math.floor(Math.random() * 3);
                if (t === 0) { const b = Math.floor(Math.random() * 10) + 2, ans = Math.floor(Math.random() * 15) + 1; q = `${b * ans} ÷ ${b} = ?`; a = ans; h = 'Pembagian'; }
                else if (t === 1) { const bases = [50, 100, 200], pct = [10, 20, 25, 50]; const base = bases[Math.floor(Math.random() * bases.length)], p = pct[Math.floor(Math.random() * pct.length)]; q = `${p}% dari ${base} = ?`; a = base * p / 100; h = 'Persentase'; }
                else { const x = Math.floor(Math.random() * 10) + 2, y = Math.floor(Math.random() * 8) + 2, z = Math.floor(Math.random() * 5) + 1; q = `${x} × ${y} + ${z} = ?`; a = x * y + z; h = 'Operasi Campuran'; }
            } else if (diff === 'hard') {
                const t = Math.floor(Math.random() * 2);
                if (t === 0) { const x = Math.floor(Math.random() * 15) + 2, coef = Math.floor(Math.random() * 3) + 2, c = Math.floor(Math.random() * 10) + 1; q = `${coef}x + ${c} = ${(x * coef) + c}, x = ?`; a = x; h = 'Persamaan Linear'; }
                else { const bases = [2, 3, 4, 5], exps = [2, 3]; const b = bases[Math.floor(Math.random() * bases.length)], e = exps[Math.floor(Math.random() * exps.length)]; q = `${b}^${e} = ?`; a = Math.pow(b, e); h = 'Perpangkatan'; }
            } else {
                const t = Math.floor(Math.random() * 2);
                if (t === 0) { const sq = [4, 9, 16, 25, 36, 49, 64, 81, 100, 121, 144][Math.floor(Math.random() * 11)]; q = `√${sq} = ?`; a = Math.sqrt(sq); h = 'Akar Kuadrat'; }
                else { const r = Math.floor(Math.random() * 7) + 3; q = `Luas lingkaran, r=${r} (π=3.14) = ?`; a = Math.round(r * r * 3.14); h = 'Geometri'; }
            }
            return { text: q, answer: a, hint: h };
        }
        function generateOptions(answer, diff) {
            const opts = [answer];
            const range = diff === 'easy' ? 10 : diff === 'medium' ? 20 : diff === 'hard' ? 30 : 50;
            while (opts.length < 4) {
                const w = Math.round((answer + (Math.floor(Math.random() * range) + 1) * (Math.random() > 0.5 ? 1 : -1)) * 100) / 100;
                if (!opts.includes(w) && w >= 0) opts.push(w);
            }
            return opts.sort(() => Math.random() - 0.5);
        }

        // =====================
        // QUIZ LOGIC
        // =====================
        function startQuiz(diff) {
            quizState.difficulty = diff;
            quizState.currentIndex = 0;
            quizState.score = 0;
            quizState.correctCount = 0;
            quizState.questions = [];
            quizState.timeLeft = settings.timePerQuestion || DIFFICULTY_CONFIG[diff].time;
            
            for (let i = 0; i < settings.questionCount; i++) quizState.questions.push(generateQuestion(diff));
            
            document.getElementById('totalQuestions').textContent = settings.questionCount;
            document.getElementById('quizModal').classList.add('active');
            document.getElementById('quizDifficulty').textContent = DIFFICULTY_CONFIG[diff].name;
            document.getElementById('quizDifficulty').className = 'quiz-difficulty ' + diff;
            
            showQuestion();
        }
        function showQuestion() {
            if (quizState.currentIndex >= quizState.questions.length) { endQuiz(); return; }
            const q = quizState.questions[quizState.currentIndex];
            document.getElementById('currentQuestion').textContent = quizState.currentIndex + 1;
            document.getElementById('questionText').textContent = q.text;
            document.getElementById('questionHint').textContent = q.hint;
            
            const opts = generateOptions(q.answer, quizState.difficulty);
            document.getElementById('optionsGrid').innerHTML = opts.map(o => `<button class="option-btn" onclick="selectAnswer(${o})">${o}</button>`).join('');
            startTimer();
        }
        function startTimer() {
            clearInterval(quizState.timerInterval);
            quizState.timeLeft = settings.timePerQuestion || DIFFICULTY_CONFIG[quizState.difficulty].time;
            document.getElementById('quizTimer').textContent = quizState.timeLeft;
            document.getElementById('quizTimer').classList.remove('warning');
            
            quizState.timerInterval = setInterval(() => {
                quizState.timeLeft--;
                document.getElementById('quizTimer').textContent = quizState.timeLeft;
                if (quizState.timeLeft <= 10) document.getElementById('quizTimer').classList.add('warning');
                if (quizState.timeLeft <= 0) { clearInterval(quizState.timerInterval); timeUp(); }
            }, 1000);
        }
        function selectAnswer(val) {
            clearInterval(quizState.timerInterval);
            const q = quizState.questions[quizState.currentIndex];
            const correct = Math.abs(val - q.answer) < 0.01;
            
            document.querySelectorAll('.option-btn').forEach(btn => {
                btn.disabled = true;
                if (parseFloat(btn.textContent) === q.answer) btn.classList.add('correct');
                else if (parseFloat(btn.textContent) === val && !correct) btn.classList.add('wrong');
            });
            
            userData.totalAnswers++;
            if (correct) { userData.correctAnswers++; userData.points += DIFFICULTY_CONFIG[quizState.difficulty].points; quizState.correctCount++; }
            saveData(); updateUI(); renderRanksList(); renderLeaderboard();
            
            setTimeout(() => { quizState.currentIndex++; showQuestion(); }, 1000);
        }
        function timeUp() {
            const q = quizState.questions[quizState.currentIndex];
            userData.totalAnswers++;
            document.querySelectorAll('.option-btn').forEach(btn => { btn.disabled = true; if (parseFloat(btn.textContent) === q.answer) btn.classList.add('correct'); });
            saveData(); updateUI();
            setTimeout(() => { quizState.currentIndex++; showQuestion(); }, 1500);
        }
        function endQuiz() {
            clearInterval(quizState.timerInterval);
            document.getElementById('quizModal').classList.remove('active');
            document.getElementById('resultScore').textContent = quizState.score + ' Poin';
            document.getElementById('resultCorrect').textContent = quizState.correctCount;
            document.getElementById('resultWrong').textContent = settings.questionCount - quizState.correctCount;
            const acc = Math.round((quizState.correctCount / settings.questionCount) * 100);
            document.getElementById('resultMessage').textContent = acc >= 80 ? 'Bagus sekali!' : acc >= 50 ? 'Lumayan!' : 'Coba lagi!';
            document.getElementById('resultModal').classList.add('active');
        }
        function closeResult() { document.getElementById('resultModal').classList.remove('active'); }
        function restartQuiz() { closeResult(); startQuiz(quizState.difficulty); }

        // =====================
        // SETTINGS & EVENTS
        // =====================
        function saveSettings() {
            userData.name = document.getElementById('playerNameInput').value || 'Player';
            settings.questionCount = parseInt(document.getElementById('questionCountSelect').value);
            settings.timePerQuestion = parseInt(document.getElementById('timePerQuestionSelect').value);
            saveData(); updateUI(); renderLeaderboard();
            showToast('Tersimpan!', 'success');
            document.getElementById('settingsPanel').classList.remove('active');
            document.getElementById('settingsOverlay').classList.remove('active');
        }
        function resetProgress() {
            if (!confirm('Yakin reset?')) return;
            const name = userData.name;
            userData = { name: name, points: 0, correctAnswers: 0, totalAnswers: 0 };
            saveData(); updateUI(); renderRanksList(); renderLeaderboard();
            showToast('Progress direset', 'success');
            document.getElementById('settingsPanel').classList.remove('active');
            document.getElementById('settingsOverlay').classList.remove('active');
        }
        function showToast(msg, type) {
            const t = document.getElementById('toast');
            t.textContent = msg; t.className = 'toast ' + type;
            setTimeout(() => t.classList.add('show'), 10);
            setTimeout(() => t.classList.remove('show'), 3000);
        }
        function setupEventListeners() {
            document.querySelectorAll('.difficulty-card').forEach(c => c.addEventListener('click', () => startQuiz(c.dataset.difficulty)));
            document.querySelectorAll('.nav-btn[data-page]').forEach(b => b.addEventListener('click', () => {
                document.querySelectorAll('.nav-btn[data-page]').forEach(x => x.classList.remove('active'));
                b.classList.add('active');
                document.getElementById('homePage').style.display = b.dataset.page === 'home' ? 'block' : 'none';
                document.getElementById('leaderboardPage').style.display = b.dataset.page === 'leaderboard' ? 'block' : 'none';
                if (b.dataset.page === 'leaderboard') renderLeaderboard();
            }));
            document.getElementById('settingsBtn').addEventListener('click', () => {
                document.getElementById('settingsPanel').classList.add('active');
                document.getElementById('settingsOverlay').classList.add('active');
            });
            document.getElementById('closeSettings').addEventListener('click', () => {
                document.getElementById('settingsPanel').classList.remove('active');
                document.getElementById('settingsOverlay').classList.remove('active');
            });
            document.getElementById('settingsOverlay').addEventListener('click', () => {
                document.getElementById('settingsPanel').classList.remove('active');
                document.getElementById('settingsOverlay').classList.remove('active');
            });
        }

        // START
        init();
    </script>
</body>
</html>
